<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Ajax Test</title>
<script type="module" defer>

  //---서버와의 비동기 통신 (Post 방식)---
function getbookList() {

  let request = new XMLHttpRequest();
  request.open("get", "bookList.jsp"); 

  //이벤트소스에 이벤트리스너 등록
  request.onreadystatechange = function(){
    //데이터 수신완료일때;
    if(request.readyState === 4){
      let parseText = JSON.parse(request.responseText);
      if(request.status === 200){
        for (const key in parseText) {
          if(key === 'list'){
              parseText['list'].forEach(list =>{
                for (const [key, value] of Object.entries(list)) {
                  showList(key+":"+value);
}
              })
            
          }
        }
     
      }else if (request.status === 404){
        // showList("404040404")
      }else if (request.status === 500){
        showList('서버 문제가 발생하였습니다.')
      }
    }else{
      // showMessage("수신중..말걸지마..")
    }
  };
  request.send();
}

//돔을 이용한 화면 동적 처리
function showList(message) {
  let body = document.querySelector('body');
  let h2 = document.createElement('h2');
  body.appendChild(h2).innerHTML = message;

}

document.querySelector('#button').addEventListener('click', function(){
  getbookList();
})


</script>
</head>
<body>
  <br>
  <button id="button">교재 목록</button>
  <h2>교재목록</h2>
</body>
</html>